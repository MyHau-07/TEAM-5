{% extends "home/master.html" %}
{% load static %}

{% block navbar %}
    {% include 'home/includes/Navbar.html' %}
{% endblock %}

{% block menu-inner %}
    {% include 'home/includes/left_menu_co.html' %}
{% endblock %}

{% block content %}
<div class="container">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-10">
                <h1 class="mt-4 text-center" style="font-weight: bold; color: #797CFF;">
                    Dashboard Quản Lý Phòng Khám
                </h1>
                
                <style>
                    .equal-height {
                        min-height: 60px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        text-align: center;
                    }
                    .metric-card {
                        transition: transform 0.2s;
                    }
                    .metric-card:hover {
                        transform: translateY(-5px);
                    }
                    .chart-container {
                        position: relative;
                        margin: auto;
                        height: 300px;
                    }
                </style>   

                <!-- Metrics Overview -->
                <div class="row mb-4">
                    <div class="col-lg-3 col-md-6">
                        <div class="card bg-primary text-white mb-4 equal-height metric-card">
                            <div class="card-body">
                                <h6 class="mb-1">Doanh Thu Hôm Nay</h6>
                                <h4 class="mb-0">50,000,000đ</h4>
                                <small><i class="fas fa-arrow-up"></i> 12% so với hôm qua</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="card bg-success text-white mb-4 equal-height metric-card">
                            <div class="card-body">
                                <h6 class="mb-1">Số Bệnh Nhân</h6>
                                <h4 class="mb-0">120</h4>
                                <small><i class="fas fa-arrow-up"></i> 5% so với tuần trước</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="card bg-warning text-white mb-4 equal-height metric-card">
                            <div class="card-body">
                                <h6 class="mb-1">Lịch Hẹn Hôm Nay</h6>
                                <h4 class="mb-0">25</h4>
                                <small>15 đã xác nhận</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <div class="card bg-info text-white mb-4 equal-height metric-card">
                            <div class="card-body">
                                <h6 class="mb-1">Đánh Giá</h6>
                                <h4 class="mb-0">4.8 <small>/5</small></h4>
                                <small>142 đánh giá mới</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row 1 -->
                <div class="row mb-4">
                    <div class="col-xl-8 col-lg-7">
                        <div class="card shadow">
                            <div class="card-header bg-transparent">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0">Doanh Thu Theo Tháng</h6>
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Tháng</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Quý</button>
                                        <button type="button" class="btn btn-sm btn-outline-secondary">Năm</button>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="revenueChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-4 col-lg-5">
                        <div class="card shadow">
                            <div class="card-header bg-transparent">
                                <h6 class="mb-0">Phân Bố Dịch Vụ</h6>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="servicesChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row 2 -->
                <div class="row mb-4">
                    <div class="col-xl-6">
                        <div class="card shadow">
                            <div class="card-header bg-transparent">
                                <h6 class="mb-0">Lịch Hẹn Theo Giờ</h6>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="appointmentsChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-6">
                        <div class="card shadow">
                            <div class="card-header bg-transparent">
                                <h6 class="mb-0">Độ Tuổi Bệnh Nhân</h6>
                            </div>
                            <div class="card-body">
                                <div class="chart-container">
                                    <canvas id="ageChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Appointments Table -->
                <div class="card shadow mb-4">
                    <div class="card-header bg-transparent">
                        <div class="d-flex justify-content-between align-items-center">
                            <h6 class="mb-0">Lịch Hẹn Gần Đây</h6>
                            <a href="#" class="btn btn-sm btn-primary">Xem Tất Cả</a>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Bệnh Nhân</th>
                                        <th>Dịch Vụ</th>
                                        <th>Thời Gian</th>
                                        <th>Trạng Thái</th>
                                        <th>Bác Sĩ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Nguyễn Văn A</td>
                                        <td>Niềng Răng</td>
                                        <td>09:00 - 10:30</td>
                                        <td><span class="badge bg-success">Đã xác nhận</span></td>
                                        <td>BS. Trần Thị B</td>
                                    </tr>
                                    <tr>
                                        <td>Trần Thị C</td>
                                        <td>Tẩy trắng</td>
                                        <td>10:30 - 11:30</td>
                                        <td><span class="badge bg-warning">Chờ xác nhận</span></td>
                                        <td>BS. Lê Văn D</td>
                                    </tr>
                                    <tr>
                                        <td>Lê Văn E</td>
                                        <td>Nhổ răng khôn</td>
                                        <td>13:30 - 14:30</td>
                                        <td><span class="badge bg-info">Đã đến</span></td>
                                        <td>BS. Phạm Văn F</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Revenue Chart
    new Chart(document.getElementById('revenueChart'), {
        type: 'line',
        data: {
            labels: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12'],
            datasets: [{
                label: 'Doanh thu (triệu đồng)',
                data: [120, 150, 170, 200, 250, 280, 300, 320, 350, 380, 400, 450],
                borderColor: '#4e73df',
                backgroundColor: 'rgba(78, 115, 223, 0.05)',
                tension: 0.3,
                fill: true
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: {
                        drawBorder: false
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });

    // Services Chart
    new Chart(document.getElementById('servicesChart'), {
        type: 'doughnut',
        data: {
            labels: ['Niềng Răng', 'Implant', 'Tẩy Trắng', 'Nhổ Răng', 'Khác'],
            datasets: [{
                data: [35, 25, 20, 15, 5],
                backgroundColor: [
                    '#4e73df',
                    '#1cc88a',
                    '#36b9cc',
                    '#f6c23e',
                    '#858796'
                ]
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
    });

    // Appointments Chart
    new Chart(document.getElementById('appointmentsChart'), {
        type: 'bar',
        data: {
            labels: ['8-10h', '10-12h', '12-14h', '14-16h', '16-18h', '18-20h'],
            datasets: [{
                label: 'Số lượng lịch hẹn',
                data: [15, 25, 12, 20, 28, 18],
                backgroundColor: '#36b9cc'
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: {
                        drawBorder: false
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });

    // Age Distribution Chart
    new Chart(document.getElementById('ageChart'), {
        type: 'pie',
        data: {
            labels: ['18-25', '26-35', '36-45', '46-55', '55+'],
            datasets: [{
                data: [15, 30, 25, 20, 10],
                backgroundColor: [
                    '#4e73df',
                    '#1cc88a',
                    '#36b9cc',
                    '#f6c23e',
                    '#858796'
                ]
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
    });
});
</script>
{% endblock %}